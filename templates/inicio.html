{% extends "base.html" %}
{% load static %}

{% block title %}
    Inicio
{% endblock %}

{% block header %}
    <a href="{% url 'ProsPy:Inicio' %}" class="logo"
    ><b>Pros<span>PY</span></b></a>
{% endblock %}
{% block content %}
    <div class="row">

        <div class="col-md-4">
            <select name="tablas" class="form-control">
                <option value="---" selected>--------</option>
                <option value="Organismo">Organismo</option>
                <option value="Reactor">Reactor</option>
                <option value="Ejercicios Batch">Ejercicios Batch</option>
            </select>
        </div>

        <div class="col-md-6">
            <div class="input-group mb-3">
                <input id="busqueda" list="listas" placeholder="Escriba o haga clic aquÃ­"/>
                <div class="input-group-append">

                    <button type="submit" onclick="buscar();" class="btn btn-block btn-outline-primary">Buscar</button>
                </div>
            </div>


            <datalist id="listas">
            </datalist>
        </div>
    </div>
     <div class="row">

    </div>

    <style>
        input {
            width: 450px;
            height: 30px;
            border: 2px solid #ccc;
            line-height: 40px;
            font-size: 16px;
            color: #333;
            padding: 5px;
            display: block;
            height: calc(2.25rem + 2px);
            padding: .375rem .75rem;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #495057;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #ced4da;
            border-radius: .25rem;
            box-shadow: inset 0 0 0 transparent;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        input:focus {
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075) inset, 0 0 8px rgba(102, 175, 233, 0.6);
            border-color: rgb(102, 175, 233);
        }
    </style>
{% endblock %}
{% block extrajs %}
    <script>

        $(function () {
            $('select[name="tablas"]').on('change', function () {
                var id = $(this).val();
                var select_batch = $('datalist[id="listas"]');
                document.getElementById("busqueda").value = "";
                var options = '<option value="">------------</option>';
                if (id === 'Organismo') {
                    $.ajax({
                        url: window.location.pathname,
                        type: 'POST',
                        data: {
                            'action': 'search_organismos',
                        },
                        dataType: 'json',
                        success: function (data) {
                            $.each(data, function (key, value) {
                                options += '<option value="' + value.nombre + '"></option>';
                            });
                            select_batch.html(options);
                            return false;
                        },
                        error: function (error) {
                        }
                    });
                }
                if (id === 'Reactor') {
                    $.ajax({
                        url: window.location.pathname,
                        type: 'POST',
                        data: {
                            'action': 'search_reactor',
                        },
                        dataType: 'json',
                        success: function (data) {
                            $.each(data, function (key, value) {
                                options += '<option value="' + value.modelo + '"></option>';
                            });
                            select_batch.html(options);
                            return false;
                        },
                        error: function (error) {
                        }
                    });
                }
                if (id === 'Ejercicios Batch') {
                    $.ajax({
                        url: window.location.pathname,
                        type: 'POST',
                        data: {
                            'action': 'search_batch',
                        },
                        dataType: 'json',
                        success: function (data) {
                            $.each(data, function (key, value) {
                                options += '<option value="' + value.titulo + '"></option>';
                            });
                            select_batch.html(options);
                            return false;
                        },
                        error: function (error) {
                        }
                    });
                }
            });
        });

        function buscar() {
            var consulta = $("#busqueda").val();
            var datos = ' ';
            $.ajax({
                url: window.location.pathname,
                type: 'post',
                data: {
                    'action': 'buscar',
                    'nombre': consulta,
                },
                dataType: 'json',
                success: function (data) {
                      console.log(data)
                    $.each(data, function (key, value) {
                        //buscar organismo
                       console.log(value)

                    });


                },
                error: function (error) {

                }
            });

        }

    </script>

{% endblock %}